commit b3d740263c08370c9e701ac372dff5cdc0ebd39d
Author: Michael Niedermayer <michael@niedermayer.cc>
Date:   Mon May 21 23:08:05 2018 +0200

    avcodec/mpeg4videoenc: Use 64 bit for times in mpeg4_encode_gop_header()
    
    Fixes truncation
    Fixes Assertion n <= 31 && value < (1U << n) failed at libavcodec/put_bits.h:169
    Fixes: ffmpeg_crash_2.avi
    
    Found-by: Thuan Pham <thuanpv@comp.nus.edu.sg>, Marcel BÃ¶hme, Andrew Santosa and Alexandru RazvanCaciulescu with AFLSmart
    
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
    (cherry picked from commit e1182fac1afba92a4975917823a5f644bee7e6e8)
    Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>

diff --git a/libavcodec/mpeg4videoenc.c b/libavcodec/mpeg4videoenc.c
index 494452c938..f6a5992df7 100644
--- a/libavcodec/mpeg4videoenc.c
+++ b/libavcodec/mpeg4videoenc.c
@@ -882,7 +882,7 @@ void ff_set_mpeg4_time(MpegEncContext *s)
 
 static void mpeg4_encode_gop_header(MpegEncContext *s)
 {
-    int hours, minutes, seconds;
+    int64_t hours, minutes, seconds;
     int64_t time;
 
     put_bits(&s->pb, 16, 0);
